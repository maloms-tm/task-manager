<!--
  Task Form Template
  
  This form is used for both creating and editing tasks.
  It uses Angular Material form components for a polished UI.
-->

<div class="task-form-container">
  <!-- Dialog Header -->
  <h2 mat-dialog-title>
    {{ isEditMode ? '✏️ Edit Task' : '➕ Add New Task' }}
  </h2>

  <!-- Form Content -->
  <mat-dialog-content>
    <form [formGroup]="taskForm" class="task-form">
      
      <!-- Title Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Task Title</mat-label>
        <input 
          matInput 
          formControlName="title"
          placeholder="Enter task title"
          maxlength="100">
        <mat-hint align="end">
          {{ taskForm.get('title')?.value?.length || 0 }}/100
        </mat-hint>
        <mat-error *ngIf="hasError('title')">
          {{ getErrorMessage('title') }}
        </mat-error>
      </mat-form-field>

      <!-- Description Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea 
          matInput 
          formControlName="description"
          placeholder="Describe the task in detail"
          rows="4"
          maxlength="500"></textarea>
        <mat-hint align="end">
          {{ taskForm.get('description')?.value?.length || 0 }}/500
        </mat-hint>
        <mat-error *ngIf="hasError('description')">
          {{ getErrorMessage('description') }}
        </mat-error>
      </mat-form-field>

      <!-- Due Date Field -->
      <div class="full-width">
        <label class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
        <input 
          type="date"
          formControlName="dueDate"
          [min]="getTodayDate()"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
          placeholder="Choose a date">
        <div *ngIf="hasError('dueDate')" class="text-red-500 text-sm mt-1">
          {{ getErrorMessage('dueDate') }}
        </div>
      </div>

      <!-- Priority and Status Row -->
      <div class="form-row">
        <!-- Priority Field -->
        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Priority</mat-label>
          <mat-select formControlName="priority">
            <mat-option *ngFor="let priority of priorityOptions" [value]="priority">
              {{ priority }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="hasError('priority')">
            {{ getErrorMessage('priority') }}
          </mat-error>
        </mat-form-field>

        <!-- Status Field -->
        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Status</mat-label>
          <mat-select formControlName="status">
            <mat-option *ngFor="let status of statusOptions" [value]="status">
              {{ status }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="hasError('status')">
            {{ getErrorMessage('status') }}
          </mat-error>
        </mat-form-field>
      </div>

    </form>
  </mat-dialog-content>

  <!-- Dialog Actions (Buttons) -->
  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()" type="button">
      Cancel
    </button>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="onSubmit()"
      [disabled]="taskForm.invalid"
      type="button">
      {{ isEditMode ? 'Update Task' : 'Create Task' }}
    </button>
  </mat-dialog-actions>
</div>

<!--
  FORM DIRECTIVES EXPLAINED:
  
  [formGroup]="taskForm" - Binds the entire form to the FormGroup in component
  formControlName="title" - Binds individual input to a FormControl
  
  CONDITIONAL STYLING:
  *ngIf="hasError('title')" - Only shows error if field has error
  [disabled]="taskForm.invalid" - Disables button when form is invalid
  
  MATERIAL COMPONENTS:
  mat-form-field - Container for input with label, hints, and errors
  appearance="outline" - Material Design style (can be 'fill' or 'outline')
  mat-label - The floating label
  mat-hint - Helper text (shows character count)
  mat-error - Error message (only shown when invalid)
  
  INTERVIEW TIP:
  Q: Why use formControlName instead of ngModel?
  A: We're using Reactive Forms. formControlName connects template inputs to
     the FormGroup in the component. ngModel is for Template-Driven Forms.
-->
